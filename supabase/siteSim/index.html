<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script src="https://unpkg.com/vue@3"></script>
    <script src="https://unpkg.com/@supabase/supabase-js"></script>

    <div id="app">
        <h1>Supabase Login Test Page</h1>

        <p>Logging in as: <input type="email" v-model="email"></p>

        <p>Bearer Token Here:</p>
        <pre style="max-width: 80%;overflow:scroll">{{ jwt }}</pre>
        <button @click="signIn()">Sign In</button>
        <button @click="checkUser()">Check User</button>
    
    </div>

    

    <script>
        const { createClient } = supabase
        const _supabase = createClient('http://localhost:54321', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24ifQ.625_WdcF3KHqz5amU0x2X5WWHP-OEs_4qj0ssLNHzTs')
    Vue.createApp({
        data() {
            return {
                email: 'brian.kelleher@uconn.edu',
                jwt: ''
            }
        },
        methods: {
            async signIn() {
                let { user, error } = await _supabase.auth.signIn({
                    email: this.email
                })

                console.log(user, error)

                console.log('signed in')
            },
            checkUser() {
                let u = _supabase.auth.user()

                if ( u ) {
                    this.jwt = JSON.parse(localStorage.getItem('supabase.auth.token')).currentSession.access_token
                }
                
            }
        }
    }).mount('#app')
    </script>
</body>
</html>